---
title: "Next.js+TypeScriptç’°å¢ƒã§Jestã‚’è¨­å®šã—ã¦ãƒ†ã‚¹ãƒˆã‚’ã™ã‚‹"
emoji: "ğŸ£"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["nextjs", "typescript"]
published: false
---


Next.js+TypeScriptç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆè¨­å®šã§ã™ã€‚

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install --save-dev jest @types/jest ts-jest react-test-renderer @types/react-test-renderer
```

## è¨­å®š

`jest.config.json`

```javascript
module.exports = {
    preset: 'ts-jest',
    globals: {
        'ts-jest': {
            tsconfig: '<rootDir>/spec/tsconfig.json'
        }
    }
}
```

`spec/tsconfig.json`

```json
{
  "extends": "../tsconfig.json",
  "include": ["./**/*"],
  "compilerOptions": {
    "jsx": "react-jsx"
  }
}
```

Next.jsã®`jsx`ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯`preserve`ã¨ãªã£ã¦ã„ã¾ã™ã€‚
ã“ã‚Œã‚’ãƒ†ã‚¹ãƒˆç”¨ã¯`react-jsx`ã«è¨­å®šã—ã¾ã™ã€‚

## react-jsx

React17ã‹ã‚‰å…¥ã£ãŸæ–°ã—ã„JSXå¤‰æ›ã§ã™ã€‚

https://ja.reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html

https://zenn.dev/uhyo/articles/react17-new-jsx-transform

TypeScriptã¯4.1ã‹ã‚‰`jsx`ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚ªãƒ—ã‚·ãƒ§ãƒ³

- `react-jsx`
- `react-jsx-dev`

ã®è¿½åŠ ã§å¯¾å¿œã•ã‚Œã¦ã„ã¾ã™ã€‚

https://devblogs.microsoft.com/typescript/announcing-typescript-4-1/#react-17-jsx-factories

https://github.com/microsoft/TypeScript/pull/39199

ã“ã‚Œã«ã‚ˆã‚Šã„ã¤ã‚‚ã®importæ–‡ãŒå¿…è¦ãªããªã‚Šã¾ã—ãŸã€‚
Next.jsç’°å¢ƒã§`jsx`ãŒ`preserve`ã§ã‚ã£ã¦ã‚‚ã€ãƒ†ã‚¹ãƒˆç”¨ã«Babelã‚’ä½¿ç”¨ã—ãªãã¦ã‚‚è‰¯ã„ã®ã§ã™ã€‚

```typescript
// ã•ã‚ˆãªã‚‰
import React from 'react'
```
